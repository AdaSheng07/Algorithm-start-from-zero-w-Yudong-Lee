## 线段树 Segment Tree

### 线段树的原理

和树状数组相比，线段树（Segment Tree）是一种更强大、更一般的数据结构，是一种基于分治思想的二叉树结构，用于在区间上进行信息统计。
</br>
- 线段树的每个节点都代表一个闭区间，节点`struct`类中内存左子节点`left`、右子节点`right`和值`data`，每个节点按层序编号，可以将数组存在数组中，不必存指针
- 线段树具有唯一的根节点，代表的区间是整个统计范围，如`[1, N]`
- 线段树的每个叶节点都代表一个长度为1的元区间`[x, x]`
- 对于每个内部节点[l, r]，它的左子节点是[l, mid]，右子节点是[mid + 1, r]，其中`mid = (l + r) / 2`（向下取整）

-------
### 线段树的存储

除去树的最后一层，整棵线段树一定是一棵完全二叉树，树的深度为`O(logN)`
</br>
可以按照与二叉堆类似的编号方法，每个节点按层次序编号，可以将编号存在数组中，不必存指针：
- 根节点的编号为1
- 编号为`p`的节点的左子节点编号为`p * 2`，右子节点编号为`p * 2 + 1`
- 线段树的最后一层编号不一定连续，跳过中间的空节点编号，所以保存线段树的数组长度不要小于`4N`

#### 证明：如果区间中共有N个元素，使用数组存储，至少需要4N存储空间

-------
### 区间最值问题（Range Maximum Query）

维护一个序列，支持：
- 查询区间最值（第`l`个数到第`r`个数的最大值）
- 单点修改（更新第`x`个数据）
- 区间统一修改（把第`l`个数到第`r`个数都置为`val`）










